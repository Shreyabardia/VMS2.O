<div class="space-y-6 animate-fade-in">
  <!-- Page Header -->
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
    <div>
      <h1 class="text-2xl sm:text-3xl font-bold text-gray-900">
        Department Master
      </h1>
      <p class="text-gray-600 mt-1">
        Manage departments and organizational structure
      </p>
    </div>
    <div class="mt-4 sm:mt-0 flex items-center space-x-2">
      <button
        routerLink="/admin/edit-user"
        class="flex items-center space-x-2 px-4 py-2 rounded-xl bg-gradient-to-r from-purple-600 to-indigo-600 text-white hover:from-purple-700 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105"
      >
        <i class="fas fa-users"></i>
        <span>Manage Users</span>
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <div class="glass-effect rounded-xl p-6 lg:p-8">
    <!-- Add Department Section -->
    <div *ngIf="!isEditing" class="space-y-8">
      <div class="space-y-6">
        <h3
          class="text-lg font-semibold text-gray-900 flex items-center space-x-2"
        >
          <i class="fas fa-plus text-blue-500"></i>
          <span>Add New Department</span>
        </h3>

        <form
          [formGroup]="addDepartmentForm"
          (ngSubmit)="addDepartment()"
          class="space-y-6"
        >
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >Organization Type <span class="text-red-500">*</span></label
              >
              <select
                formControlName="organizationType"
                class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200"
              >
                <option value="">Select Organization Type</option>
                <option *ngFor="let org of organizationTypes" [value]="org">
                  {{ org }}
                </option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >Department Name <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                formControlName="departmentName"
                class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200"
                placeholder="Enter department name"
              />
            </div>
            <div class="md:col-span-2">
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >Description</label
              >
              <textarea
                formControlName="description"
                rows="3"
                class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200"
                placeholder="Enter department description"
              ></textarea>
            </div>
          </div>

          <div class="flex flex-col sm:flex-row gap-4 pt-6">
            <button
              type="submit"
              [disabled]="addDepartmentForm.invalid"
              class="flex-1 flex items-center justify-center space-x-2 px-6 py-3 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-medium hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105"
            >
              <i class="fas fa-plus"></i>
              <span>Add Department</span>
            </button>
            <button
              type="button"
              (click)="addDepartmentForm.reset()"
              class="flex-1 flex items-center justify-center space-x-2 px-6 py-3 rounded-xl border border-gray-300 text-gray-700 font-medium hover:bg-gray-50 transition-all duration-300"
            >
              <i class="fas fa-undo"></i>
              <span>Reset Form</span>
            </button>
          </div>
        </form>
      </div>

      <!-- Departments List Section -->
      <div class="space-y-6">
        <div class="flex items-center justify-between">
          <h3
            class="text-lg font-semibold text-gray-900 flex items-center space-x-2"
          >
            <i class="fas fa-list-alt text-green-500"></i>
            <span>Departments List</span>
          </h3>
          <button
            (click)="exportDepartments()"
            class="flex items-center space-x-2 px-4 py-2 rounded-xl bg-gradient-to-r from-green-500 to-blue-500 text-white hover:from-green-600 hover:to-blue-600 transition-all duration-300 transform hover:scale-105"
          >
            <i class="fas fa-file-export"></i>
            <span>Export</span>
          </button>
        </div>

        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th
                  class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  Actions
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  Organization Type
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  Department Name
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  Description
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  Created Date
                </th>
                <th
                  class="px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
                >
                  Actions
                </th>
              </tr>
            </thead>
            <tbody
              [formGroup]="filterForm"
              class="bg-white divide-y divide-gray-200"
            >
              <!-- Filter Row -->
              <tr class="bg-gray-50">
                <td class="px-6 py-3">
                  <span class="text-sm text-gray-500">Actions</span>
                </td>
                <td class="px-6 py-3">
                  <div class="relative">
                    <input
                      type="text"
                      formControlName="organizationType"
                      placeholder="Filter Organization"
                      class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 text-sm"
                    />
                    <button
                      *ngIf="filterForm.get('organizationType')?.value"
                      (click)="clearFilter('organizationType')"
                      class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-gray-600"
                    >
                      <i class="fas fa-times"></i>
                    </button>
                  </div>
                </td>
                <td class="px-6 py-3">
                  <div class="relative">
                    <input
                      type="text"
                      formControlName="departmentName"
                      placeholder="Filter Department"
                      class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 text-sm"
                    />
                    <button
                      *ngIf="filterForm.get('departmentName')?.value"
                      (click)="clearFilter('departmentName')"
                      class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-gray-600"
                    >
                      <i class="fas fa-times"></i>
                    </button>
                  </div>
                </td>
                <td class="px-6 py-3">
                  <div class="relative">
                    <input
                      type="text"
                      formControlName="description"
                      placeholder="Filter Description"
                      class="w-full px-3 py-2 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 text-sm"
                    />
                    <button
                      *ngIf="filterForm.get('description')?.value"
                      (click)="clearFilter('description')"
                      class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-gray-600"
                    >
                      <i class="fas fa-times"></i>
                    </button>
                  </div>
                </td>
                <td class="px-6 py-3">
                  <span class="text-sm text-gray-500">Created Date</span>
                </td>
                <td class="px-6 py-3">
                  <span class="text-sm text-gray-500">Actions</span>
                </td>
              </tr>

              <!-- No Data Row -->
              <ng-container
                *ngIf="(paginatedDepartments$ | async)?.length === 0"
              >
                <tr>
                  <td colspan="6" class="px-6 py-12 text-center">
                    <div class="flex flex-col items-center space-y-3">
                      <div
                        class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center"
                      >
                        <i class="fas fa-building text-gray-400 text-2xl"></i>
                      </div>
                      <div>
                        <p class="text-gray-500 font-medium">
                          No departments found
                        </p>
                        <p class="text-gray-400 text-sm">
                          No departments match your criteria
                        </p>
                      </div>
                    </div>
                  </td>
                </tr>
              </ng-container>

              <!-- Data Rows -->
              <ng-container
                *ngFor="
                  let department of paginatedDepartments$ | async;
                  let i = index
                "
              >
                <tr class="hover:bg-gray-50 transition-colors duration-200">
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center space-x-2">
                      <button
                        (click)="editDepartment(department)"
                        class="flex items-center space-x-1 px-3 py-1 rounded-lg bg-blue-100 text-blue-700 hover:bg-blue-200 transition-colors duration-200"
                      >
                        <i class="fas fa-edit text-sm"></i>
                        <span class="text-xs">Edit</span>
                      </button>
                    </div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm text-gray-900">
                      {{ department.organizationType }}
                    </div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center">
                      <div
                        class="w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center"
                      >
                        <i class="fas fa-building text-white text-sm"></i>
                      </div>
                      <div class="ml-3">
                        <div class="text-sm font-medium text-gray-900">
                          {{ department.departmentName }}
                        </div>
                      </div>
                    </div>
                  </td>
                  <td class="px-6 py-4">
                    <div
                      class="text-sm text-gray-900 max-w-xs truncate"
                      title="{{ department.description }}"
                    >
                      {{ department.description }}
                    </div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm text-gray-900">
                      {{ department.createdAt }}
                    </div>
                  </td>
                  <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex items-center space-x-2">
                      <button
                        (click)="editDepartment(department)"
                        class="flex items-center space-x-1 px-3 py-1 rounded-lg bg-blue-100 text-blue-700 hover:bg-blue-200 transition-colors duration-200"
                      >
                        <i class="fas fa-edit text-sm"></i>
                        <span class="text-xs">Edit</span>
                      </button>
                      <button
                        (click)="deleteDepartment(department)"
                        class="flex items-center space-x-1 px-3 py-1 rounded-lg bg-red-100 text-red-700 hover:bg-red-200 transition-colors duration-200"
                      >
                        <i class="fas fa-trash text-sm"></i>
                        <span class="text-xs">Delete</span>
                      </button>
                    </div>
                  </td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>

        <!-- Pagination -->
        <div
          class="flex flex-col sm:flex-row justify-between items-center mt-6"
          *ngIf="totalPages > 0"
        >
          <div class="flex items-center space-x-2 text-sm text-gray-600">
            <span>Page {{ currentPage }} of {{ totalPages }}</span>
            <span class="text-gray-400">|</span>
            <span>{{ totalItems }} total departments</span>
          </div>
          <div class="flex items-center space-x-1 sm:space-x-2 mt-4 sm:mt-0">
            <button
              (click)="previousPage()"
              [disabled]="currentPage === 1"
              class="flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 text-sm"
            >
              <i class="fas fa-chevron-left text-sm"></i>
              <span class="hidden sm:inline">Previous</span>
            </button>
            <div class="flex items-center space-x-1">
              <ng-container *ngFor="let page of pages">
                <button
                  *ngIf="page !== '...'"
                  (click)="goToPage(+page)"
                  [class.bg-blue-600]="currentPage === page"
                  [class.text-white]="currentPage === page"
                  class="px-2 sm:px-3 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 transition-all duration-200 text-sm min-w-[2.5rem] sm:min-w-[2.75rem]"
                >
                  {{ page }}
                </button>
                <span
                  *ngIf="page === '...'"
                  class="px-2 sm:px-3 py-2 text-gray-400 text-sm"
                  >...</span
                >
              </ng-container>
            </div>
            <button
              (click)="nextPage()"
              [disabled]="currentPage === totalPages"
              class="flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 text-sm"
            >
              <span class="hidden sm:inline">Next</span>
              <i class="fas fa-chevron-right text-sm"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Department Form -->
    <div *ngIf="isEditing" class="space-y-8">
      <div class="space-y-6">
        <h3
          class="text-lg font-semibold text-gray-900 flex items-center space-x-2"
        >
          <i class="fas fa-edit text-orange-500"></i>
          <span>Edit Department: {{ selectedDepartment?.departmentName }}</span>
        </h3>

        <form
          [formGroup]="editForm"
          (ngSubmit)="saveDepartment()"
          class="space-y-6"
        >
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >Organization Type <span class="text-red-500">*</span></label
              >
              <select
                formControlName="organizationType"
                class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200"
              >
                <option value="">Select Organization Type</option>
                <option *ngFor="let org of organizationTypes" [value]="org">
                  {{ org }}
                </option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >Department Name <span class="text-red-500">*</span></label
              >
              <input
                type="text"
                formControlName="departmentName"
                class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200"
              />
            </div>
            <div class="md:col-span-2">
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >Description</label
              >
              <textarea
                formControlName="description"
                rows="3"
                class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200"
              ></textarea>
            </div>
          </div>

          <div class="flex flex-col sm:flex-row gap-4 pt-6">
            <button
              type="submit"
              [disabled]="editForm.invalid"
              class="flex-1 flex items-center justify-center space-x-2 px-6 py-3 rounded-xl bg-gradient-to-r from-orange-500 to-yellow-500 text-white font-medium hover:from-orange-600 hover:to-yellow-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105"
            >
              <i class="fas fa-save"></i>
              <span>Save Changes</span>
            </button>
            <button
              type="button"
              (click)="cancelEdit()"
              class="flex-1 flex items-center justify-center space-x-2 px-6 py-3 rounded-xl border border-gray-300 text-gray-700 font-medium hover:bg-gray-50 transition-all duration-300"
            >
              <i class="fas fa-times"></i>
              <span>Cancel</span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
